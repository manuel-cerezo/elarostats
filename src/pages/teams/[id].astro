---
import Layout from "../../layouts/Layout.astro";
import { getAllTeams } from "../../lib/teams";
import { getTeamLogoUrl } from "../../utils/playerStats";
import PlayerPageSearchWithQuery from "../../components/PlayerPageSearchWithQuery";
import TeamRosterWithQuery from "../../components/TeamRosterWithQuery";
import LanguageSelectorWithQuery from "../../components/LanguageSelectorWithQuery";
import ThemeToggleWithQuery from "../../components/ThemeToggleWithQuery";
import TranslatedTextWithQuery from "../../components/TranslatedTextWithQuery";

export async function getStaticPaths() {
  const teams = await getAllTeams();
  return teams.map((team) => ({
    params: { id: String(team.teamId) },
    props: { team },
  }));
}

const { team } = Astro.props;
const teamLogoUrl = getTeamLogoUrl(team.teamId);
---

<Layout title={`${team.teamName} â€” elarostats`}>
  <header class="flex items-center justify-between border-b border-gray-100 px-6 py-4 dark:border-gray-800">
    <a
      href="/"
      class="flex items-center gap-2 text-sm text-gray-500 transition hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M19 12H5M12 19l-7-7 7-7"></path>
      </svg>
      <TranslatedTextWithQuery client:only="react" k="back" />
    </a>

    <a href="/" class="text-lg font-extrabold tracking-tight">
      elaro<span class="text-orange-500">stats</span>
    </a>

    <div class="flex items-center gap-2">
      <ThemeToggleWithQuery client:only="react" />
      <LanguageSelectorWithQuery client:only="react" />
      <div class="w-48">
        <PlayerPageSearchWithQuery client:only="react" />
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-3xl px-4 py-12">
    <div class="flex items-center gap-6">
      {
        teamLogoUrl && (
          <img
            src={teamLogoUrl}
            alt={team.teamName}
            class="h-24 w-24 flex-shrink-0 object-contain"
          />
        )
      }
      <div>
        <p class="text-sm font-medium uppercase tracking-widest text-gray-400 dark:text-gray-500">
          {team.location}
        </p>
        <h1 class="text-4xl font-extrabold text-gray-900 dark:text-white">{team.simpleName}</h1>
        <p class="mt-1 text-gray-500 dark:text-gray-400">{team.abbreviation}</p>
      </div>
    </div>

    <p class="mb-1 mt-10 text-xs font-semibold uppercase tracking-widest text-gray-400 dark:text-gray-500">
      <TranslatedTextWithQuery client:only="react" k="roster" />
    </p>

    <TeamRosterWithQuery client:only="react" team={team} />
  </main>
</Layout>
