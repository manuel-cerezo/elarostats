---
import Layout from "../../layouts/Layout.astro";
import { getAllTeams } from "../../lib/teams";
import { getTeamLogoUrl } from "../../utils/playerStats";
import TeamRosterWithQuery from "../../components/TeamRosterWithQuery";
import TranslatedTextWithQuery from "../../components/TranslatedTextWithQuery";

export async function getStaticPaths() {
  const teams = await getAllTeams();
  return teams.map((team) => ({
    params: { id: String(team.teamId) },
    props: { team },
  }));
}

const { team } = Astro.props;
const teamLogoUrl = getTeamLogoUrl(team.teamId);

const description = `Plantilla y estadísticas avanzadas de ${team.teamName}. Roster completo con DPM, RAPM y métricas de rendimiento de cada jugador.`;

const jsonLd = {
  "@context": "https://schema.org",
  "@type": "SportsTeam",
  name: team.teamName,
  sport: "Basketball",
  memberOf: {
    "@type": "SportsOrganization",
    name: "NBA",
  },
  url: `https://elarostats.vercel.app/teams/${team.teamId}`,
  logo: teamLogoUrl
    ? `https://elarostats.vercel.app${teamLogoUrl}`
    : undefined,
};
---

<Layout
  title={`${team.teamName} — elarostats`}
  description={description}
  ogImage={teamLogoUrl}
  jsonLd={jsonLd}
>
  <main class="mx-auto max-w-3xl px-4 py-12">
    <div class="flex items-center gap-6">
      {
        teamLogoUrl && (
          <img
            src={teamLogoUrl}
            alt={team.teamName}
            class="h-24 w-24 flex-shrink-0 object-contain"
          />
        )
      }
      <div>
        <p class="text-sm font-medium uppercase tracking-widest text-gray-400 dark:text-gray-500">
          {team.location}
        </p>
        <h1 class="text-4xl font-extrabold text-gray-900 dark:text-white">{team.simpleName}</h1>
        <p class="mt-1 text-gray-500 dark:text-gray-400">{team.abbreviation}</p>
      </div>
    </div>

    <p
      class="mb-1 mt-10 text-xs font-semibold uppercase tracking-widest text-gray-400 dark:text-gray-500"
    >
      <TranslatedTextWithQuery client:only="react" k="roster" />
    </p>

    <TeamRosterWithQuery client:only="react" team={team} />
  </main>
</Layout>
